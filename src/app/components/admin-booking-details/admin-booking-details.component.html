<div class="admin-booking-details" *ngIf="!isLoading && !error && details as d">
  <div class="admin-booking-details__header">
    <button class="btn" type="button" (click)="onBack()">Back to admin</button>
    <div class="admin-booking-details__title">
      <span class="admin-booking-details__label">Booking</span>
      <span class="admin-booking-details__id">#{{ d.id }}</span>
      <span class="status-chip" [ngClass]="'status-chip--' + (d.status || 'ACTIVE').toLowerCase()">
        {{ d.status }}
      </span>
    </div>
  </div>

  <div class="admin-booking-details__grid">
    <section class="admin-card">
      <h2 class="admin-card__title">Booking summary</h2>
      <div class="admin-card__row">
        <span class="label">Date</span>
        <span class="value">{{ d.startTime | date: 'fullDate' }}</span>
      </div>
      <div class="admin-card__row">
        <span class="label">Time</span>
        <span class="value">{{ d.startTime | date: 'shortTime' }} â€“ {{ d.endTime | date: 'shortTime' }}</span>
      </div>
      <div class="admin-card__row">
        <span class="label">Court</span>
        <span class="value">{{ d.courtName }}</span>
      </div>
      <div class="admin-card__row">
        <span class="label">Club</span>
        <span class="value">{{ d.clubName }}</span>
      </div>
      <div class="admin-card__row">
        <span class="label">Sport</span>
        <span class="value">{{ d.activityName }} ({{ d.sportKey }})</span>
      </div>
      <div class="admin-card__row">
        <span class="label">Duration</span>
        <span class="value">{{ d.durationMinutes }} min</span>
      </div>
      <div class="admin-card__row">
        <span class="label">Created at</span>
        <span class="value">{{ d.createdAt | date: 'medium' }}</span>
      </div>
      <div class="admin-card__row">
        <span class="label">Price</span>
        <span class="value price">{{ d.price | convertMoney:(d.currency || 'EUR') }}</span>
      </div>
    </section>

    <section class="admin-card">
      <h2 class="admin-card__title">Client & contact</h2>
      <div class="admin-card__row">
        <span class="label">User</span>
        <span class="value">{{ d.username }} (ID {{ d.userId }})</span>
      </div>
      <div class="admin-card__row" *ngIf="d.userEmail">
        <span class="label">Email</span>
        <span class="value">
          {{ d.userEmail }}
          <button class="link-btn" type="button" (click)="copyEmail()">Copy</button>
        </span>
      </div>
      <div class="admin-card__row" *ngIf="d.userPhone">
        <span class="label">Phone</span>
        <span class="value">
          {{ d.userPhone }}
          <button class="link-btn" type="button" (click)="copyPhone()">Copy</button>
        </span>
      </div>
      <div class="admin-card__row" *ngIf="d.paymentType">
        <span class="label">Payment</span>
        <span class="value">{{ d.paymentType }}</span>
      </div>
    </section>

    <section class="admin-card admin-card--actions">
      <h2 class="admin-card__title">Actions</h2>
      <p class="admin-card__hint">
        Use these controls to manage this booking. Advanced actions (no-show, check-in, lock) will be added later.
      </p>
      <div class="admin-card__actions">
        <button
          type="button"
          class="btn btn--primary"
          [disabled]="isCancelling || !details"
          (click)="onCancelBooking()"
        >
          Cancel booking
        </button>
        <button
          type="button"
          class="btn btn--ghost"
          (click)="onBack()"
        >
          Back to manage bookings
        </button>
      </div>
    </section>
  </div>
</div>

<div class="admin-booking-details admin-booking-details--loading" *ngIf="isLoading">
  <p>Loading booking details...</p>
</div>

<div class="admin-booking-details admin-booking-details--error" *ngIf="!isLoading && error">
  <p>{{ error }}</p>
  <button class="btn" type="button" (click)="onBack()">Back</button>
</div>
